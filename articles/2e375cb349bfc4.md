---
title: "Reactãƒãƒ¼ã‚¸ãƒ§ãƒ³18ã§react-beautiful-dndãŒä½¿ãˆãªã„å•é¡Œã‚’è§£æ±ºã™ã‚‹"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Javascript, React, Typescript]
published: true
---

# ã¯ã˜ã‚ã«

`react-beautiful-dnd` ã¯ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ãŒç°¡å˜ã«å®Ÿè£…ã§ãã‚‹ä¾¿åˆ©ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
ã§ã™ãŒ `React` ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 ä»¥é™ã«ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
ãã“ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 16 ã‚„ 17 ã«ã—ã¦å®Ÿè£…ã™ã‚‹ã®ã‚‚è‰¯ã„ã®ã§ã™ãŒã€
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 ã§ã‚‚å®Ÿè£…ã§ãã‚‹æ–¹æ³•ã‚’èª¿æŸ»ã—ã¾ã—ãŸã®ã§ã“ã“ã«è¨˜è¼‰ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

# è¿½è¨˜

ç¾åœ¨(2023/8/6)ã§ã¯ã“ã¡ã‚‰ã®Issueã§`React`ãƒãƒ¼ã‚¸ãƒ§ãƒ³18ã§ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã§ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆé ‚ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
https://github.com/atlassian/react-beautiful-dnd/issues/2388
ãã‚Œã§ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„å ´åˆã®ã¿ä»¥ä¸‹ã‚’èª­ã¿é€²ã‚ã¦ãã ã•ã„ã€‚

# React ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 ä»¥é™ã§ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„

## React ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 æº–å‚™

`create-react-app` ã—ã¦ `React` ã‚’æº–å‚™ã—ã¾ã™ã€‚
å®Œäº†å¾Œã€`pacjage.json` è¦‹ã‚‹ã¨ `React` ãƒãƒ¼ã‚¸ãƒ§ãƒ³ `18.0.2` ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚
![packagejsonBrefore](/images/articles/beautifuldndInstallNG.png)

## react-beautiful-dnd ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã“ã“ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ `react-beautiful-dnd` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã™ã€‚

```shell
$ npm install react-beautiful-dnd
```

ã™ã‚‹ã¨ã“ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

```shell
npm ERR! code ERESOLVE
npm ERR! ERESOLVE unable to resolve dependency tree
npm ERR!
npm ERR! While resolving: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå@0.1.0
npm ERR! Found: react@18.2.0
npm ERR! node_modules/react
npm ERR!   react@"^18.2.0" from the root project
npm ERR!
npm ERR! Could not resolve dependency:
npm ERR! peer react@"^16.8.5 || ^17.0.0" from react-beautiful-dnd@13.1.0
npm ERR! node_modules/react-beautiful-dnd
npm ERR!   react-beautiful-dnd@"*" from the root project
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
npm ERR!
npm ERR! See /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/.npm/eresolve-report.txt for a full report.

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/.npm/_logs/2022-07-27T13_46_41_808Z-debug-0.log
```

ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¦‹ã‚‹ã¨ã€`react-beautiful-dnd` ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ `13.1.0` ã¯
`React` ãƒãƒ¼ã‚¸ãƒ§ãƒ³ `16.8.5` ã‹ã‚‰ `17.0.0` ã«å¯¾å¿œã—ã¦ã„ã‚‹ã¨ã®ã“ã¨ã€‚

# è§£æ±ºæ–¹æ³•

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

`React` ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ 17 ã¾ã§è½ã¨ã›ã°ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ãŒã€
ã›ã£ã‹ããªã‚‰ `React`ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 ã§é–‹ç™ºã—ãŸã„ã€ã¨ã„ã†ã“ã¨ã§ã•ã‚‰ã«ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ã¿ã¦ã¿ã¾ã™ã€‚
ä¾å­˜é–¢ä¿‚ã®ç«¶åˆã‚’ä¿®æ­£ã™ã‚‹å ´åˆã¯ã€å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰ã«`--force`ã‚‚ã—ãã¯`--legacy-peer-deps`ã¤ã‘ã¦å†å®Ÿè¡Œã—ã¦ã­ã€
ã¨è¨˜è¼‰ãŒã‚ã‚‹ã®ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã«ä¿®æ­£ã—ã¦å†å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```shell
$ npm install react-beautiful-dnd --legacy-peer-deps
```

ã“ã‚Œã§ã‚¨ãƒ©ãƒ¼ãªãã‚³ãƒãƒ³ãƒ‰ãŒå®Œäº†ã§ããŸã®ã§`package.json`ã‚’ç¢ºèªã—ã¾ã™ã€‚
![packagejsonAfter](/images/articles/beautifuldndInstallOK.png)

## ã•ã‚‰ã«ã‚³ãƒ¼ãƒ‰ä¿®æ­£ã‚‚å¿…è¦

ã“ã“ã¾ã§ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã—ãŸã®ã§ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã§ãã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚
`react-beautiful-dnd` ã‚’ä½¿ç”¨ã—ãŸãƒªã‚¹ãƒˆã‚’ãƒ†ã‚¹ãƒˆçš„ã«ä½œæˆã—ã¦ã¿ã¾ã™ã€‚

```React:TestList.js
export const TestList = [
  {
    id: "01",
    name: "ã¿ã‹ã‚“",
  },
  {
    id: "02",
    name: "ã‚Šã‚“ã”",
  },
  {
    id: "03",
    name: "ã¶ã©ã†",
  },
  {
    id: "04",
    name: "ãƒ¡ãƒ­ãƒ³",
  },
];
```

```React:App.jsx
import { useState } from "react";
import { DragDropContext, Draggable, Droppable } from "react-beautiful-dnd";
import { TestList } from "./TestList";
import "./App.css";

function App() {
  const [testList, setTestList] = useState(TestList);
  const onDragEndTest = (result) => {
    const items = [...testList];
    const deleteItem = items.splice(result.source.index, 1);
    items.splice(result.destination.index, 0, deleteItem[0]);

    setTestList(items);
  };

  return (
    <div className="App">
      <h1>ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—</h1>
      <DragDropContext onDragEnd={onDragEndTest}>
        <Droppable droppableId="droppableId">
          {(provided) => (
            <div
              className="testListArea"
              {...provided.droppableProps}
              ref={provided.innerRef}
            >
              {testList.map(({ id, name }, index) => {
                return (
                  <Draggable key={id} draggableId={id} index={index}>
                    {(provided) => (
                      <div
                        className="testItem"
                        ref={provided.innerRef}
                        {...provided.draggableProps}
                        {...provided.dragHandleProps}
                      >
                        <div>
                          {id}ï¼š{name}
                        </div>
                      </div>
                    )}
                  </Draggable>
                );
              })}
              {provided.placeholder}
            </div>
          )}
        </Droppable>
      </DragDropContext>
    </div>
  );
}
export default App;
```

`react-beautiful-dnd`ã®æ›¸ãæ–¹ã¯ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚
https://dev.classmethod.jp/articles/react-beautiful-dnd-react-ts/

ã“ã‚Œã§ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ã¿ã‚ˆã†ã¨ã™ã‚‹ã¨
æ–‡å­—åˆ—ãŒé¸æŠã•ã‚Œã‚‹ã ã‘ã§ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
![DragAndDropgifNG](/images/articles/DragAndDropNG.gif)

ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«è‰²ã€…èª¿æŸ»ã—ã¦ã¿ã‚‹ã¨ã€
**`React`ãŒ`StrictMode`ã§å‹•ã„ã¦ã„ã‚‹**ã“ã¨ãŒåŸå› ã®ã‚ˆã†ã§ã™ã€‚
`StrictMode`ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ãã ã•ã„[React ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]
https://ja.reactjs.org/docs/strict-mode.html

ã¨ã„ã†ã“ã¨ã§ã€`index.js` ã®`<React.StrictMode>`ã‚’å‰Šé™¤ã—ã¦ä¿®æ­£ã—ã¦ã¿ã¾ã™ã€‚

ä¿®æ­£å‰

```React:index.js
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';
import reportWebVitals from './reportWebVitals';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

ä¿®æ­£å¾Œ

```React:index.js
import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';
import App from './App';
import reportWebVitals from './reportWebVitals';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
    <App />
);
```

ä¿®æ­£å¾Œãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ã¿ã‚‹ã¨
ç„¡äº‹ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
![DragAndDropgifOK](/images/articles/DragAndDropOK.gif)

# ã¾ã¨ã‚

`react-beautiful-dnd` ã‚’ `React` ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 18 ã§ä½¿ãˆãªã„ã‚‚ã®ã‹ã¨è€ƒãˆã¦ã„ãŸã¨ã“ã‚
ã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆãŒãªã‹ã£ãŸã®ã§è‰²ã€…èª¿æŸ»ã—ãŸçµæœã‚’ä»Šå›ã“ã®è¨˜äº‹ã«ã—ã¦ã¿ã¾ã—ãŸã€‚
åŒã˜ã‚ˆã†ãªæ‚©ã¿ã‚’æŒã£ã¦ã„ã‚‹æ–¹ã®å‚è€ƒã«ãªã‚Œã°å¬‰ã—ã„ã§ã™ã€‚

# å‚è€ƒã‚µã‚¤ãƒˆ

https://github.com/atlassian/react-beautiful-dnd/issues/2426

https://github.com/atlassian/react-beautiful-dnd/issues/2399
